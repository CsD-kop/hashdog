"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),_get=function(t,e,s){for(var i=!0;i;){var a=t,r=e,o=s;n=u=h=void 0,i=!1,null===a&&(a=Function.prototype);var n=Object.getOwnPropertyDescriptor(a,r);if(void 0!==n){if("value"in n)return n.value;var h=n.get;return void 0===h?void 0:h.call(o)}var u=Object.getPrototypeOf(a);if(null===u)return void 0;t=u,e=r,s=o,i=!0}},_BaseWorker2=require("./BaseWorker"),_utilUtil=require("./../util/Util"),Permutator=function(t){function e(t){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.permutations=0,this.lastPermutations=0,this.options={},this.currentMaxLength=0,this.data.name="<Bruteforce> Permutations",this.data.processId=process.pid,this.data.status="Initializing..."}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(this.options=t,this.options.length){if(this.options.length>=16)return void console.log("Exceeded maximum key length!")}else this.options.length=2;this.permutations=0,this.lastPermutations=0,this.string="",this.data.keyLength=this.options.length,this.data.keysTotal=Math.pow(this.options.chars.length,this.options.length);for(var e=0;e<this.options.length;e++)this.string+=" ";this.permute(this.options.length)}},{key:"permute",value:function(t){var e=void 0,s=void 0,i=void 0,a=void 0,r=void 0,o=void 0,n=void 0;if(0===t)parseInt(this.permutations)>=parseInt(this.data.keysTotal)-1&&(this.data.status="Unsuccessful",this.data.success=!1,this.data.uptime=process.uptime().toFixed(2),this.data.keysTried=this.permutations+1,this.data.percentage=100,this.data.string="",this.sendStatus(),process.send({command:"DONE",workerId:this.data.workerId})),s=this.hasher.hash(this.string),s===this.match&&(this.data.status="SUCCESS",this.data.success=!0,this.data.uptime=process.uptime(),this.data.keysTried=this.permutations,this.data.hash=s,this.data.string=this.string,this.sendStatus(),process.exit(0)),i=new Date,a=i-this.lastDate,a>=this.refreshRate&&(r=this.permutations-this.lastPermutations,o=(this.permutations/this.data.keysTotal*100).toFixed(2),n=r*(1e3/a),this.data.status="Working",this.data.success=!1,this.data.uptime=process.uptime().toFixed(2),this.data.keysTried=this.permutations,this.data.rate=n/1e3,this.data.percentage=o,this.data.string=this.string,this.sendStatus(),this.lastPermutations=this.permutations,this.lastDate=i),this.permutations++;else for(e=0;e<this.options.chars.length;e++)this.string=_utilUtil.Util.replaceCharAtIndex(this.string,t-1,this.options.chars[e]),this.permute(t-1)}}]),e}(_BaseWorker2.BaseWorker);exports.Permutator=Permutator;