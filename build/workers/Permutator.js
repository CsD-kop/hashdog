"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Permutator=void 0;var _BaseWorker2=require("./BaseWorker"),_Util=require("./../util/Util"),Permutator=exports.Permutator=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this,t));return s.permutations=0,s.lastPermutations=0,s.options={},s.currentMaxLength=0,s.data.name="<Bruteforce> Permutations",s.data.processId=process.pid,s.data.status="Initializing...",s}return _inherits(e,t),_createClass(e,[{key:"initialize",value:function(t){if(this.options=t,this.options.length){if(this.options.length>=16)return void console.log("Exceeded maximum key length!")}else this.options.length=2;this.permutations=0,this.lastPermutations=0,this.string="",this.data.keyLength=this.options.length,this.data.keysTotal=Math.pow(this.options.chars.length,this.options.length);for(var e=0;e<this.options.length;e++)this.string+=" ";this.permute(this.options.length)}},{key:"permute",value:function(t){var e=0,s="",i=null,a=0,r=0,n=0,o=0;if(0===t)parseInt(this.permutations)>=parseInt(this.data.keysTotal)-1&&(this.data.status="Unsuccessful",this.data.success=!1,this.data.uptime=process.uptime().toFixed(2),this.data.keysTried=this.permutations+1,this.data.percentage=100,this.data.string="",this.sendStatus(),process.send({command:"DONE",workerId:this.data.workerId})),s=this.hasher.hash(this.string),s===this.match&&(this.data.status="SUCCESS",this.data.success=!0,this.data.uptime=process.uptime(),this.data.keysTried=this.permutations,this.data.hash=s,this.data.string=this.string,this.sendStatus(),process.exit(0)),i=new Date,a=i-this.lastDate,a>=this.refreshRate&&(r=this.permutations-this.lastPermutations,n=(this.permutations/this.data.keysTotal*100).toFixed(2),o=r*(1e3/a),this.data.status="Working",this.data.success=!1,this.data.uptime=process.uptime().toFixed(2),this.data.keysTried=this.permutations,this.data.rate=o/1e3,this.data.percentage=n,this.data.string=this.string,this.sendStatus(),this.lastPermutations=this.permutations,this.lastDate=i),this.permutations++;else for(e=0;e<this.options.chars.length;e++)this.string=_Util.Util.replaceCharAtIndex(this.string,t-1,this.options.chars[e]),this.permute(t-1)}}]),e}(_BaseWorker2.BaseWorker);